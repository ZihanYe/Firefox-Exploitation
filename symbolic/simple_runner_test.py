import angr 
import logger

log = logging.getLogger("angr")
log.setLevel('INFO')

corefile = "/nas/ug16zy2/corefiles/CVE20195808.core"
ap = angr.Project(corefile, main_opts={'backend': 'elfcore'},rebase_granularity=0x1000, auto_load_libs=False)

ss = angr.factory.AngrObjectFactory(ap).blank_state()
simgr = ap.factory.simgr(ss)

uaf_object_base = 0x3253a95217a0
uaf_object_size = 176
for i in range():
	symbolic_byte = ss.solver.BVS("obj" + str(i), 8)
    ss.memory.store(uaf_object_base+i, symbolic_byte, inspect=False)

stop = False
while not stop:
	simgr.step()
	stop = simgr.stashes['active'] == 0

import IPython; IPython.embed;

