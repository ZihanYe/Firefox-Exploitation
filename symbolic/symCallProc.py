import angr

class SymCallProc(angr.SimProcedure):
    NO_RET = False
    IS_FUNCTION = True

    def run(self):
        print('hooking symbolic call')
        # Fork two sucessors:
        # one is returning unconstrainted symbolic value (assuming we can control whatever it returns)
        # one is returning a pointer to unconstrained memory (assuming we cannot control, but the return value is a pointer)

        # return a value of size 64 bits
        ret_symbol = self.state.solver.BVV(1, 64)
        self.ret(expr=ret_symbol)
