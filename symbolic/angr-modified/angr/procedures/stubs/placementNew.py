import angr

######################################
# placement new

# push   %rbp
# mov    %rsp,%rbp
# mov    %rdi,-0x8(%rbp)
# mov    %rsi,-0x10(%rbp)
# mov    -0x10(%rbp),%rax
# pop    %rbp
# retq
######################################

class placementNew(angr.SimProcedure):
    #pylint:disable=arguments-differ
    def run(self):
        ret_ptr = self.state.regs.rsi
        rsp = self.state.regs.rsp
        self.state.memory.store(rsp-0x8, self.state.regs.rdi)
        self.state.memory.store(rsp-0x10, self.state.regs.rsi)
        return ret_ptr
