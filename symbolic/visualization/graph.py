import matplotlib.pyplot as plt

files = [# 'CVE-2018-18492_6_step.log',
        'CVE-2018_5104_2_step.log',
        'CVE-2018-5102_1_step.log',
        'CVE-2018-5100_2_step.log',
        'CVE-2018-5097_2_step.log',
        'CVE-2017-7828_2_step.log',
        'CVE-2017-7784_3_step.log']

ids = [# 'CVE-2018-18492',
    'CVE-2018_5104',
    'CVE-2018-5102',
    'CVE-2018-5100',
    'CVE-2018-5097',
    'CVE-2017-7828',
    'CVE-2017-7784']

marker = ['.', ',', 'o', '^', 's', '>', '<']
# step vs number of active states
data = []
for f in files:
    xs = []
    ys = []
    with open(f) as fp:
        line = fp.readline()
        while line:
            nums = line.split()
            xs.append(int(nums[0]))
            ys.append(int(nums[1]))
            line = fp.readline()
    data.append((xs, ys))

# plot
i = 0
for (xs,ys) in data:
    plt.plot(xs, ys, label=ids[i], marker=marker[i], markersize=3)
    i += 1

plt.xlabel("Steps")
plt.ylabel("Number of active states")
plt.legend()
plt.savefig("states.png")
# steps vs
