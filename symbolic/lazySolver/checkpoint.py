import angr
import logging
log = logging.getLogger("symbolic")

class Checkpoint(angr.SimStatePlugin):
    def __init__(self, checkstate=None, ret_vars=[], exploring=False, ret_symbol=None, constraints_for_self=[], goal=None):
        super(Checkpoint, self).__init__()
        self.ret_vars = ret_vars
        self.checkstate = checkstate
        self.exploring = exploring
        # self
        self.ret_symbol = ret_symbol
        self.constraints_for_self = constraints_for_self
        self.finish_goal = goal

    @angr.SimStatePlugin.memo
    def copy(self, memo):
        return Checkpoint(self.checkstate, self.ret_vars.copy(), self.exploring, self.ret_symbol, self.constraints_for_self.copy(), self.finish_goal)

from angr.sim_state import SimState
SimState.register_default('checkpoint', Checkpoint)
