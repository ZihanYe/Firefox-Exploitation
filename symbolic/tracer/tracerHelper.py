import angr
import logging
log = logging.getLogger("symbolic")

class TracerHelper(angr.SimStatePlugin):
    def __init__(self, guide_state, trace_idx, heap_match=None):
        self.trace_idx = trace_idx
        self.guide_state = guide_state
        self.heap_match = heap_match

    @angr.SimStatePlugin.memo
    def copy(self, memo):
        if self.heap_match is not None:
            return TracerHelper(self.guide_state, self.trace_idx, self.heap_match.copy())
        else:
            return TracerHelper(self.guide_state, self.trace_idx)
