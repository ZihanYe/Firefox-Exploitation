import executor

# e = executor.Executor("/home/ug16zy2/angr-dev/symbolic/tests/CVE-2018-18492/core.19261", stop_when_active_more_than=600)
# e = executor.Executor("/home/ug16zy2/angr-dev/symbolic/tests/CVE-2018-18492/core.19261", log_interval=100, log_file='out.log', debug=False)
# e.run(uaf_object_base=0x00005569804e00c0, uaf_object_size=280, context_end=0x00007f6825c02e7f)
# 21352
# e.run(uaf_object_base=0x00005654bd2dbe30, uaf_object_size=280, context_end=0x00007f0bc9ac0e7f)
# 19261
# e.run(uaf_object_base=0x563f3d81f200, uaf_object_size=280, context_end=0x00007fbb8e699e7f)

# core
# e = executor.Executor("/nas/ug16zy2/core", log_interval=100, log_file='out.log', debug=False)
# e.run(uaf_object_base=0x561408707030, uaf_object_size=280, context_end=0x00007f38bb5e4b5a)

# core.30041
libc_funcs = [(0x7f21035fdc30, 'libc','realloc'),
                (0x00007f21035fc950, 'libc','free'),
                (0x00007f21035fc070, 'libc','malloc'),
                (0x7f21035c9dc0, 'libc','fprintf'),
                (0x00007f2103620460, 'libc', 'memcpy'),
                (0x00007f2103603c10, 'libc', 'memcmp'),
                (0x00007f2103603d40, 'libc', 'memset')
                ]
e = executor.Executor("/nas/ug16zy2/firefox-63.0.3/core.30041", stop_when_control_hijack_found=True, stop_when_write_primtive_found=True, log_interval=50, log_file='out.log', debug=False), lib_call_hook=libc_funcs)
e.run(uaf_object_base=0x424d0f0, uaf_object_size=280, context_end=0x00007f20f02bab66)
