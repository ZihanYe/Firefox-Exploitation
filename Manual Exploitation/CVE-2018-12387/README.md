# CVE-2018-12387

Infoleak bug from Hack2Win

Version of Firefox I tried: 57.0 (ASAN build)

## Crash:

run ```./mach run --debug --disable-e10s --ion-eager ../CVE-2018-12387/crash.html```

gives:

==2407==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000009 (pc 0x7fffe55b4feb bp 0x7ffffffe60f0 sp 0x7ffffffe5d60 T0)
==2407==The signal is caused by a READ memory access.
==2407==Hint: address points to the zero page.
    #0 0x7fffe55b4fea in JSObject::getClass() const /home/clover/firefox-57.0/js/src/jsobj.h:104
    #1 0x7fffe55b4fea in JSObject::getOpsGetProperty() const /home/clover/firefox-57.0/js/src/jsobj.h:116
    #2 0x7fffe55b4fea in js::GetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<JS::Value>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>) /home/clover/firefox-57.0/js/src/vm/NativeObject.h:1588


## Exploitation


According to https://bugzilla.mozilla.org/show_bug.cgi?id=1493903
This can lead to a info leak exploitation that gets XUL base address, stack and heap addresses.


Reference:

[1] https://ssd-disclosure.com/archives/3766

[2] https://bugzilla.mozilla.org/show_bug.cgi?id=1493903
